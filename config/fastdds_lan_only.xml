<?xml version="1.0" encoding="UTF-8"?>
<!--
  Fast DDS profile that restricts communication to the LAN interface (192.168.0.0/24).
  This disables builtin transports and uses a custom UDPv4 transport with an interface whitelist.

  Notes:
  - The CIDR 192.168.0.0/24 allows any host on that subnet, so it works across multiple machines.
  - If your LAN subnet differs, change it accordingly (e.g., 192.168.1.0/24).
  - To force ROS 2 to use this profile for all nodes in a launch, set the environment variable
    FASTDDS_DEFAULT_PROFILES_FILE (and FASTRTPS_DEFAULT_PROFILES_FILE for older versions)
    to point to this file.
-->
<profiles xmlns="http://www.eprosima.com/XMLSchemas/fastRTPS_Profiles">
  <transport_descriptors>
    <transport_descriptor>
      <transport_id>udp_lan_only</transport_id>
      <type>UDPv4</type>
      <interfaceWhiteList>
        <!-- IMPORTANT: Fast DDS expects concrete interface IPs here (no CIDR).
             Set this to the local machine's LAN IP address.
             Example for this host: 192.168.0.111 -->
        <address>192.168.0.111</address>
        <address>192.168.0.125</address>
        <address>192.168.0.253</address>
        <address>192.168.0.254</address>
      </interfaceWhiteList>
      <!-- Optional tuning: increase send/receive buffer sizes if needed
      <sendBufferSize>1048576</sendBufferSize>
      <receiveBufferSize>1048576</receiveBufferSize>
      -->
    </transport_descriptor>
  </transport_descriptors>

  <participant profile_name="lan_only_participant" is_default_profile="true">
    <rtps>
      <!-- Use only the custom UDP transport above -->
      <useBuiltinTransports>false</useBuiltinTransports>
      <userTransports>
        <transport_id>udp_lan_only</transport_id>
      </userTransports>
      <!-- Keep multicast discovery enabled on the LAN -->
      <builtin>
        <discovery_config>
          <discoveryProtocol>SIMPLE</discoveryProtocol>
          <!-- <use_STATIC_EndpointDiscoveryProtocol>false</use_STATIC_EndpointDiscoveryProtocol> -->
        </discovery_config>
        <!-- <initialPeersList> 
          <locator>
            <udpv4><address>192.168.0.111</address></udpv4>
          </locator>
          <locator>
            <udpv4><address>192.168.0.125</address></udpv4>
          </locator>
          <locator>
            <udpv4><address>192.168.0.253</address></udpv4>
          </locator>
          <locator>
            <udpv4><address>192.168.0.254</address></udpv4>
          </locator>
        </initialPeersList> -->
      </builtin>
    </rtps>
  </participant>
</profiles>
